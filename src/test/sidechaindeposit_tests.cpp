// Copyright (c) 2017 The Bitcoin Core developers
// Distributed under the MIT software license, see the accompanying
// file COPYING or http://www.opensource.org/licenses/mit-license.php.

#include "sidechain.h"
#include "sidechaindb.h"
#include "validation.h"

#include "test/test_drivenet.h"

#include <boost/test/unit_test.hpp>

BOOST_FIXTURE_TEST_SUITE(sidechaindeposit_tests, TestingSetup)

std::vector<SidechainDeposit> Get10TestDeposits()
{
    // Serialization of 10 real sidechain deposits, in valid CTIP spend order.
    // None of these deposits spend the same transaction.

    std::string strD1 = "005c0eadeaefd2bbf3f2cbfe582f46bbc68f684cc802000000013217dba663204d566719a6015b91ff471c92aa034415b9345f8d7a34e4f878fb0000000049483045022100f7dfb944857712ccb57ae799a6623f97d7b19dbf4787589f9aed69ac9317f35d022064812ffc0edc083618dedd9b20ab8ff71c2e771d204f46b31aaf7178b5f2ce1501ffffffff038081748e000000001976a91466318e78399bf9b87c6ddff400689ff8f79933c188ac0000000000000000166a145c0eadeaefd2bbf3f2cbfe582f46bbc68f684cc800e1f505000000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac0000000002000000a5ad41ed3edbcdbfa6bda6b3fdf327cc4f3fe5743359da6fa70b748a3f296deb";

    std::string strD2 = "005c0eadeaefd2bbf3f2cbfe582f46bbc68f684cc80200000002b844ec6c77987fb1a42fa08d84385c5e269c8df293a64fe4e5eb146446c28488000000004847304402203987d03da254084054891de79869e75d8eabfae0ce43df2f8fca7e983c8510a6022006545085bbd20b9e2580eb6f4f62e641fdff497c3a2ae4ade467f29b8325ad2501ffffffff826d76bd7a014c7bcbd1879ceb0def511fe04e7c305f32ea06cc4210fb2cd2cf020000008a4730440220502e4dee549524e0cc0eb92d9ccf2e23725b8e8096437482aedff7e4f4436a4902206169d66accf18dd54d469ed0e5774006e91d7a65aa74d5680ed66df1f517c62e0141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff0380a07e88000000001976a914be36e47b30c914d8cdb03491adf846759569323188ac0000000000000000166a145c0eadeaefd2bbf3f2cbfe582f46bbc68f684cc800a3e111000000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac0000000002000000a5ad41ed3edbcdbfa6bda6b3fdf327cc4f3fe5743359da6fa70b748a3f296deb";

    std::string strD3 = "005c0eadeaefd2bbf3f2cbfe582f46bbc68f684cc802000000027b15d9a56bb5bc86677d98decdf560a2f698157bbe43902b0b7a2e1ed0edde8a000000004847304402201dcc95bef87a6941fd0e9c550c885430b7047313728a787b66e06c8b10ccccf102204dadde11cdeffddec0271c511aa900ad48b3c15f3e55d176aa921706213a3b1401ffffffff9ad23036982e1ba5bc7581c17699dcddd66039e90fde763a4de9366361f18c0c020000008a47304402200f3e8f81fec4430556edf3b41a73c52e9793ad20a14033808b58cd44b5aa564602203a6846e8011e438382c2d8fce854776aea87fa2562d888c362efe4f75facf5120141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff0380bf8882000000001976a91455c933220b712464f291490be2fd70c63ba6e93988ac0000000000000000166a145c0eadeaefd2bbf3f2cbfe582f46bbc68f684cc80046c323000000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac0000000002000000a5ad41ed3edbcdbfa6bda6b3fdf327cc4f3fe5743359da6fa70b748a3f296deb";

    std::string strD4 = "005c0eadeaefd2bbf3f2cbfe582f46bbc68f684cc802000000029231554038a478e1b4784f93453836cc221dd0c35b4d310df5328127874e2bec000000004948304502210098c0e57ae1004d0b80aaf849270f4ad1724e66da2147d3f1091369d05e23ab21022059fbaa0907a3b9c59a53478cfc8ef81a7929fcc624d301fb407786b5ee8a95f201ffffffff10658449598ab26d0186a2f1ca06e5110aa73b802bef4afb95a704aa9c6f7fac020000008b483045022100a6a164a91221f5f52cf9333d72915b498bc3188184c9214ba9744364278199780220022cea8ce6ea86083d7e4f97ee39b65b032ab181625ca605df325c680987f4760141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff0380de927c000000001976a914b6d6e509fd74ee3277203e3704cb1771a2d84c6988ac0000000000000000166a145c0eadeaefd2bbf3f2cbfe582f46bbc68f684cc800ca9a3b000000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac0000000002000000a5ad41ed3edbcdbfa6bda6b3fdf327cc4f3fe5743359da6fa70b748a3f296deb";

    std::string strD5 = "005c0eadeaefd2bbf3f2cbfe582f46bbc68f684cc80200000002c8ad87ec9f120645ab92d4b8251a43146d29d7376fb5e6efa234eb0086cd55330000000049483045022100e798581c9e2db242a6f15305073d826933eab5f5f4396f7988214aaf4b83bfb502201ed7914c84eaad305314f737f3e90cbe8a9020dc9f88882e5a51ee2e87cb349c01ffffffff3a2ce037cd75d9c02f23da5aa8218a21b461b74861a99e9635ec660c3b98af0c020000008b483045022100adf9f45e89b76afbc48c17bdcf17116836c06ca6e6583d5c57f526f4db242b2b022075079b64ef1da40341ef9e3fac5de435f023febb6041727e06b700bcdb488a410141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff0380fd9c76000000001976a91492a58f252fa93b23998c6679dcf81cf73b079d9a88ac0000000000000000166a145c0eadeaefd2bbf3f2cbfe582f46bbc68f684cc8002f6859000000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac0000000002000000a5ad41ed3edbcdbfa6bda6b3fdf327cc4f3fe5743359da6fa70b748a3f296deb";

    std::string strD6 = "005c0eadeaefd2bbf3f2cbfe582f46bbc68f684cc80200000002e1e14a9f22b4eaeb2f2ee3cb81884e3e0c3d2cbc4cec547c0648d68de2dc964a000000004847304402207841f961ad21712d85e0a67f52f47b6085f286a6501ce34d453d424581f73d5a022044d2f11b869e253ddb24094cf5a95ff9dd7a94ab7dc45011fe5286c990ae375c01ffffffffc75799558ad82c1779e435c6509d493c337ca1da5ba329ae14a99f73949188a0020000008a47304402205ef111bd93887eb8163cb5a0bdbef5f7b851f46ae904a6f718341e66a8d8d1890220385139adcbc3587b9077f357974f726abd016c981467ad84b807d76d0610adb00141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff03801ca770000000001976a914351463e4aa1baa05c44add711a12135eabd9cfb588ac0000000000000000166a145c0eadeaefd2bbf3f2cbfe582f46bbc68f684cc800752b7d000000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac0000000002000000a5ad41ed3edbcdbfa6bda6b3fdf327cc4f3fe5743359da6fa70b748a3f296deb";

    std::string strD7 = "005c0eadeaefd2bbf3f2cbfe582f46bbc68f684cc802000000025d66336fc645ae2af814ab6669820bf13a5a96692068bc83107211d6fbb7945500000000484730440220092a91ad5facfacb8352051316cfd1b2d58a2b41b354cc99459eac972c01d5030220263d2a293500cd5056bcf99432c483d094f598e0a2fa4254ff70edc655bc1b9801ffffffff930a3516a949f207992f2477ce28f650ce8baf2ea74989bf714394fed42ceb8c020000008a47304402201b1dd6603cf7589079a11ab851283551de9a45d44f9e43ccc4afdbd108c162800220535d6db0162bf7de6bd8fec9f79ef98f3ade56ce410cfbda538cef4c33fa8f680141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff03803bb16a000000001976a9149c3d55916f94c470d121d49f7d0a5536f0ebf42388ac0000000000000000166a145c0eadeaefd2bbf3f2cbfe582f46bbc68f684cc8009ce4a6000000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac0000000002000000a5ad41ed3edbcdbfa6bda6b3fdf327cc4f3fe5743359da6fa70b748a3f296deb";

    std::string strD8 = "005c0eadeaefd2bbf3f2cbfe582f46bbc68f684cc80200000002d13186d008dba3f47ec76f8bd6a3cf6ac391739b000a0d8e37ae24abbb79aba4000000004847304402207169aa543456fc0b3e63b8ec04c5632943cd28944949f9fc3582f483c16de58302201a6c967d4ccbe5325296000b85ccd1cd35dbd7127c32e623c4c17c0a8d24567b01ffffffffad659e4bdf31098422ec760eafca26a962a684001ecaadfcfc24403ab5a739e7020000008a4730440220100e7e0460dbe00a6ab5be38ebf54c594981ddbf607f44f5062077133c93b1b4022021e241b37719e4478afa7eafd81048ec74126ae1de5ac35040a4de4bddf63f590141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff03805abb64000000001976a9145e4cba495e645b2b5131101015666de1e4d8358e88ac0000000000000000166a145c0eadeaefd2bbf3f2cbfe582f46bbc68f684cc800a493d6000000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac0000000002000000a5ad41ed3edbcdbfa6bda6b3fdf327cc4f3fe5743359da6fa70b748a3f296deb";

    std::string strD9 = "005c0eadeaefd2bbf3f2cbfe582f46bbc68f684cc80200000002606649d62f4ba1effd687450d9a5e5b06b7c6a24184ca49566279471aa47b8580000000048473044022073c2b2f2529944c921278a001ae9e7990c13f99020757d0e2c79277c257875e4022061941dfad912fe498f97bbcbe4880263b6802ed6e2800c3160e03ca5ddbf24a801ffffffff1ba75acc31d5cdefb2ebdb48c3a7e0310f8566400c973f0ca8f0577a89b22a7c020000008a473044022042f983a195387ddd342314642d3dfa21dfc744449222340f40f271e251330ef402206c7f441ec60ead3c67f5d60a02d0834fe1b0dfdde73c335c52f6a3778f07ae280141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff038079c55e000000001976a914da9ac2cc1b0c0dd99e4b4d9b34e23b799d821b2e88ac0000000000000000166a145c0eadeaefd2bbf3f2cbfe582f46bbc68f684cc8008d380c010000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac0000000002000000a5ad41ed3edbcdbfa6bda6b3fdf327cc4f3fe5743359da6fa70b748a3f296deb";

    std::string strD10 = "005c0eadeaefd2bbf3f2cbfe582f46bbc68f684cc80200000002ab6803f7c3a9782769aadd260ce6c817b2edaedaea4755229dc3944c51a77fbe0000000049483045022100b39d23164003f9e58a33e3b13768008946f18433ccaab184efd8ecbae4056c1e022040db49556dd9c22e4180088ccccc955f2720681fbbe4ca825853cbebdc0322e101ffffffff94bdd88ba3aaee095c4f7d8006921060b687059854601e5e886e0bbd9ca4ec5f020000008b4830450221008352a38162f6163b894d29e404750f4a2d1e94d614c2020b086b9e26363e86cf0220517ba0a9bfc8873cc51b8291e649e1a25fb38a87d6ab078ed903484c4808d5d00141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff038098cf58000000001976a9148883fed4eba74660f3ce3ba035dc2168c80e035b88ac0000000000000000166a145c0eadeaefd2bbf3f2cbfe582f46bbc68f684cc80057d347010000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac0000000002000000a5ad41ed3edbcdbfa6bda6b3fdf327cc4f3fe5743359da6fa70b748a3f296deb";

    CDataStream ss1(ParseHex(strD1), SER_DISK, CLIENT_VERSION);
    CDataStream ss2(ParseHex(strD2), SER_DISK, CLIENT_VERSION);
    CDataStream ss3(ParseHex(strD3), SER_DISK, CLIENT_VERSION);
    CDataStream ss4(ParseHex(strD4), SER_DISK, CLIENT_VERSION);
    CDataStream ss5(ParseHex(strD5), SER_DISK, CLIENT_VERSION);
    CDataStream ss6(ParseHex(strD6), SER_DISK, CLIENT_VERSION);
    CDataStream ss7(ParseHex(strD7), SER_DISK, CLIENT_VERSION);
    CDataStream ss8(ParseHex(strD8), SER_DISK, CLIENT_VERSION);
    CDataStream ss9(ParseHex(strD9), SER_DISK, CLIENT_VERSION);
    CDataStream ss10(ParseHex(strD10), SER_DISK, CLIENT_VERSION);

    // Unserialize the testing deposits

    SidechainDeposit d1;
    ss1 >> d1;
    SidechainDeposit d2;
    ss2 >> d2;
    SidechainDeposit d3;
    ss3 >> d3;
    SidechainDeposit d4;
    ss4 >> d4;
    SidechainDeposit d5;
    ss5 >> d5;
    SidechainDeposit d6;
    ss6 >> d6;
    SidechainDeposit d7;
    ss7 >> d7;
    SidechainDeposit d8;
    ss8 >> d8;
    SidechainDeposit d9;
    ss9 >> d9;
    SidechainDeposit d10;
    ss10 >> d10;

    std::vector<SidechainDeposit> vDeposit { d1, d2, d3, d4, d5, d6, d7, d8, d9, d10 };

    // Enable this for debugging
    //int i = 0;
    //for (const SidechainDeposit& d : vDeposit) {
    //    std::cout << "Deposit " << i << ":\n";
    //    std::cout << d.ToString() << std::endl;
    //    i++;
    //}

    return vDeposit;
}

std::vector<SidechainDeposit> Get25TestDeposits()
{
    // Serialization of 25 real sidechain deposits, in valid CTIP spend order.
    // Some of these spend a different outpoint of the same transaction.

    std::string strD1 = "00dc24e2f1b749151460c377e91e4c1f08b25e988702000000000101a395fce35a324296d63e26637aecb3f051a82607cfb4d8e6013c52988be91ed201000000171600147f599ceccbabca237c49ba8dcd2b2c4eb82c74c9ffffffff03c0b1098e000000001976a9141cf5a085ff0867dbd8c6ad5b3139b5462ae1c91688ac0000000000000000166a14dc24e2f1b749151460c377e91e4c1f08b25e988700e1f505000000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac0247304402202379b9af24e61e77acba4bde0ee4e4cc2328ac9dd0ced273c690492fa7ddd608022079c29949ab7cc5f1bab113ab8e704c70c9dcc17fb01ef133a3f229c2ac61f2a901210386f73058dee300022b900fe901dbaa5f9439c783b0c57164b2ede76bab19867a000000000200000057eb9960b49570f8940d27c01a27ca81147e365f103a999d9e1aa21969a0bf8f";

    std::string strD2 = "00dc24e2f1b749151460c377e91e4c1f08b25e9887020000000242609aefada298d316b5345eff2010de8deb69c1c58f610046099d6750f506e3000000004948304502210087975f2edb466f247cdca004f914ccc66111c26bbae5e07fb995c397a0e62d0b022010bf2e799d576a8cad6795689d2fc0ac9e257f8162076c00207ada0650ca286d01ffffffff4104976b46e49409a2b47ca1f7bca0c2a3486b3110ea9dd2e66a02b0f553cd35020000008a47304402201d0612d01084f66786421d2bb07cb6de9096c25829458c84f0e282519bbb84a7022057c94166b3328c3e907ece9d674a92ebef92bbdfcf5f0b6842543cf50261b1450141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff0380a07e88000000001976a914e3cecc017bebb81c9854113176a012d3e4e9476b88ac0000000000000000166a14dc24e2f1b749151460c377e91e4c1f08b25e988700a3e111000000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000200000057eb9960b49570f8940d27c01a27ca81147e365f103a999d9e1aa21969a0bf8f";

    std::string strD3 = "00dc24e2f1b749151460c377e91e4c1f08b25e988702000000029aaf5dccd6051330aa7af526355ca9a414d8014a63478bbe5bf3ca9821c435e2000000004847304402205cf49fd58db5c6c7d1be3e4d2259e746388888b9240963303c9aabf8efbf06d5022073b3f24c8d85493d739dace46b49ef7933a53807074d1a6b9086ef1314b2cd6001ffffffff48973c3fb03e5dc1c15c2d1f6e115c4d15de901270e18a5f01e720671aa1bee0020000008b483045022100b0f9f00153152e9fcaa4a582cfaca30816ca530d53dfd8e410f9a7d6d5434ab2022068eb9dfb09833f84f60ec5909db7c5945f04a11ff68b894159915ca3559bb91b0141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff0380bf8882000000001976a9143ba13e1a6ebbf5ed55fd1fca0b933dfc17b6d56788ac0000000000000000166a14dc24e2f1b749151460c377e91e4c1f08b25e98870046c323000000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000200000057eb9960b49570f8940d27c01a27ca81147e365f103a999d9e1aa21969a0bf8f";

    std::string strD4 = "00dc24e2f1b749151460c377e91e4c1f08b25e9887020000000273e1206b1a47d0795c1979f811d81f1e525ded13c26e6edf84d0af6dc71f9af2000000004847304402207767f6a823ae220e468cc4b7a7af4d8a2ba028f38ef8c5ebe5c50c5ebd1baa9b02203095fafeaf5f9c82c5d3f3587ed0bcdadabd42fdb41dfae9982b5cd04b1ee17b01ffffffff5958fb24829242134e45d7d6efaa1c5b112692253770dad32206ef5b5e0171fc020000008b483045022100da9c57b7756db6ef9e29d1e93aefaff37abb4caac21a8b3e8d46c658b81cd5f6022047c4e2cc41d99cea3ceabb84d64368b4823ff15e522c443faf5e09dcd45321ad0141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff0380de927c000000001976a914378578ab4f1b744c79d01e62eabd74221ae5b7d188ac0000000000000000166a14dc24e2f1b749151460c377e91e4c1f08b25e988700ca9a3b000000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000200000057eb9960b49570f8940d27c01a27ca81147e365f103a999d9e1aa21969a0bf8f";

    std::string strD5 = "00dc24e2f1b749151460c377e91e4c1f08b25e988702000000027e16667dc9c459bf246e2387eba85ba52e6166c04fc6b54655a5c8027ada765b000000004847304402203c4977e16636ff44196b1b02fdeff358db1c3cbbee639911bfa22f97b20e404802206536c4530f5246fb588be38064f308959aaab4864529c90753692b68b352f43d01ffffffff71f1c2b4dfec7472cc860331476e222891dc5709fb0aba75de128af7c540ecf0020000008a473044022051ce93cdc0e4d49b8a59daadba258b4d2299458709b889c6a5f6bcae36cafcbc02202e5cb6b20ada4fdc3963d2224e7d17055885879a5392706bff45a78e84dfbde30141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff0380fd9c76000000001976a914544a5eaccdb7f450b8c1bbbd841b3fada64fe33988ac0000000000000000166a14dc24e2f1b749151460c377e91e4c1f08b25e9887002f6859000000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000200000057eb9960b49570f8940d27c01a27ca81147e365f103a999d9e1aa21969a0bf8f";

    std::string strD6 = "00dc24e2f1b749151460c377e91e4c1f08b25e9887020000000287957030608507e957dccbfcc2f54377802708a15fa287fe69065471307f0e6f0000000049483045022100b60d15574c5dc6359a0ad917c8b37dfed4ac60a83c9e6f1b5fed5d37b9cb2fae02206ee9cec92ee89ba1653e55418e1d7baebfbc48ddfa27213552276c6656abb1ac01ffffffff0eaaa1fe93d08b0fc189e94dd2b398c48591b755cf86033986c850592a3daab9020000008a473044022007b716baf8801f7adf82b03d6bf32b810993dafe527f3b0afb7e03aa893255ed022041d7ad8100da4c68ea9f05fe194693a3e8decefb29aa995b7335323353d9e9320141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff03801ca770000000001976a914eab57326dba6bb8914fba515f9a815adc408c33288ac0000000000000000166a14dc24e2f1b749151460c377e91e4c1f08b25e988700752b7d000000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000200000057eb9960b49570f8940d27c01a27ca81147e365f103a999d9e1aa21969a0bf8f";

    std::string strD7 = "00dc24e2f1b749151460c377e91e4c1f08b25e98870200000002974824fb263bbfcc88b9ac4497f00ca71a79741944418e86a5d02cb4daeef258000000004847304402207e93c42346221161a413d704b1ea0e04873ccb4b396fe7bf7e037d6940aa898d02207d1021bf3912ae227d7d0facb1bce64ec52b5a2111c1313f1de4034f5dd8342c01ffffffff4d6076c478ac2ea133d66c92542c9bb5b95fc9b26a0d68b354014d737d7519da020000008a47304402204e5b2344d06bee13ad0591cd00e6d255cea69849d640764977a1a9cee17ee354022003fb41a10ac8ad8756946e620cd408c8cf537504beface76741e05621aa614f80141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff03803bb16a000000001976a914327c4e642ec53669a41b7fe365c64f013171afae88ac0000000000000000166a14dc24e2f1b749151460c377e91e4c1f08b25e9887009ce4a6000000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000200000057eb9960b49570f8940d27c01a27ca81147e365f103a999d9e1aa21969a0bf8f";

    std::string strD8 = "00dc24e2f1b749151460c377e91e4c1f08b25e988702000000025f347d7a237ef35ad95c5c9a44f796d09eb033ce7b93bceb1c40de2fa2921eda0000000049483045022100e95575d9f688f58ba1db704a543979d8ff8a05ce9a4d3578d857e20619d8f4a802201ae9975b0ad22e778e4e9a99b95ef75b8a35e45c868a075e0974b5035f0196f001ffffffff1306c2283b23c88e7a19876d7d2b54ec110b2aa70988df7afe7b67d0a18590f9020000008b483045022100d410f46f2da395faa61d72c0d38d91f4a6d1f5579a3d9046a2290001a01b349b022013933c7eea593b4c221cf9d78832fca8f719f93004033b646f482873695b16670141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff03805abb64000000001976a914ca7fd3108df6a1543bf79f69cdbb3d2a570c7bbf88ac0000000000000000166a14dc24e2f1b749151460c377e91e4c1f08b25e988700a493d6000000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000200000057eb9960b49570f8940d27c01a27ca81147e365f103a999d9e1aa21969a0bf8f";

    std::string strD9 = "00dc24e2f1b749151460c377e91e4c1f08b25e988702000000022ce7bf81b3c316b7b434dfeada137a0bae013be47fb1b71dc55ea682563a9a66000000004847304402206fe22a4d99bf085e82324c343c6a2fb2113809a7dbf66cffceeaca9cc1ffa834022032f643432597e2af2b699fb9206f0d3b06148cffaf94f67ec25e1bce993a7e4801ffffffff50a2d020d4fdec9737e8ba962bdab2e097d8ef243efac2a72a59ce47be75a238020000008a47304402206ac94f507013d7ea9234847216b3a4457e07e1d928c009c4558679313ed0fd01022067a90f2d8d7e170cd0b1a9168c01cb6769d4bfe94dd12579f83ee1d8897333560141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff038079c55e000000001976a914d0c18efa5c5053f18e647bb1d552000479c338e488ac0000000000000000166a14dc24e2f1b749151460c377e91e4c1f08b25e9887008d380c010000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000200000057eb9960b49570f8940d27c01a27ca81147e365f103a999d9e1aa21969a0bf8f";

    std::string strD10 = "00dc24e2f1b749151460c377e91e4c1f08b25e988702000000020170288153f4135a2741c344ba465d3a92348d8aa64fdf338c9666f6205a2bf10000000049483045022100b6cd312d6e33fcde96d59132dda5d26558c4e06c4a64e05ffeae4345533a268b0220587337a8f2a65b6c554bb1bcc4883fcfd5e0882e8047fadc03e2ab4e442ab8a701ffffffff890a9bdae301913be58f21ff182d765a2048b8be2baf39e65490ba6d1122fd2c020000008a473044022046532b9ed3d64aa33b3528bbe3c1cb27f67a9c20decc780a920501eceb33722f022062f819571df668c21a702074727662ccb3da6d37cd7b11b57e8b2ce72db125170141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff038098cf58000000001976a914ec26ffe2cec5ed0618be6d6298a96b8bb4ee605188ac0000000000000000166a14dc24e2f1b749151460c377e91e4c1f08b25e98870057d347010000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000200000057eb9960b49570f8940d27c01a27ca81147e365f103a999d9e1aa21969a0bf8f";

    std::string strD11 = "00dc24e2f1b749151460c377e91e4c1f08b25e9887020000000285dfd1886b4d58284d42c587105f87bbc95aac9ba8a4271a6f713299bb9bfc0900000000494830450221008fd7eff7c66a9a002fef844a1f48c8a223e28801c540748d2b2c9e4fd0dcbe3202201da0b95517019e989cdade6c5fb6e80f14fe81f88edf1d3eaec50e860fae2a9001ffffffff42f13684d54021e7ace771cd6c064fcf13dbe0fe7ad377d84774fcb33c5b7708020000008a47304402202471026009495fef47d2f5f050445839b7870f36e923b07e24e21ba5d7aa64f302205483d6bbe363eecd4fcd66f80b590120de31d2ec4d04110f97c0fce8cd0ebb230141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff0380b7d952000000001976a914e08a2ce1547603bb94951523484b16750d68069c88ac0000000000000000166a14dc24e2f1b749151460c377e91e4c1f08b25e988700026489010000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000200000057eb9960b49570f8940d27c01a27ca81147e365f103a999d9e1aa21969a0bf8f";

    std::string strD12 = "00dc24e2f1b749151460c377e91e4c1f08b25e98870200000002ba729c9de1b1d97fbb0a92b5124bee2fc1cf08dc8b95a2c7f5904050745866560000000049483045022100a587ed8698d776b301137f742ac8498ed7cd87363abf678f939c43c35adac41902202faac40c412dca93d77e1c3404204cab4205b76883a4d5b6e2161603ee7174c201ffffffff5ee5dc5e050f629fe50a0d8e5387824b2e0f168b578e8b9f5e9c18725a926a6a020000008b483045022100d7ff868a254b9cdf04cda93bd81a1b9adc9c0637568b4705a71f68110bf355e302201aef2c1c67ddf933d5ba9d86d1b1a66f1a276f23d2ccce2223407a2ac2a55b910141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff0380d6e34c000000001976a9148d5560bf30a271722dc87568e32e2f82e0b261e088ac0000000000000000166a14dc24e2f1b749151460c377e91e4c1f08b25e9887008eead0010000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000200000057eb9960b49570f8940d27c01a27ca81147e365f103a999d9e1aa21969a0bf8f";

    std::string strD13 = "00dc24e2f1b749151460c377e91e4c1f08b25e988702000000022388bdbe95a2bb77763085fe34958eeefb20847f4c2d52a3308257e9823899ed000000004847304402205a79500c3f2cbfacba20af3d4dea4b0b42ca74eff754bcff0deb444ef2321e9b0220361f3b795b8e31d22c2ad0d4ed05113df82221620e56307221976d6d82c6a0d201ffffffff22a2b479cea310c8d77dc7d6c6dc090b3c36bd7a5b8ffa9fed570d861c567b98020000008a47304402202db81bc1228de567b879f77f814dd945f07f878e9532382a90b0b0ccd7ba51b902201dc545875e4be8a563270af0ae4a53edcdb4533d76cfc66e697921c4c87b52d50141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff0380f5ed46000000001976a914a061518e864927384090cecb5c90b33bf351b55688ac0000000000000000166a14dc24e2f1b749151460c377e91e4c1f08b25e988700fb661e020000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000200000057eb9960b49570f8940d27c01a27ca81147e365f103a999d9e1aa21969a0bf8f";

    std::string strD14 = "00dc24e2f1b749151460c377e91e4c1f08b25e9887020000000210d9edfe0b091a2568b5816cc409487a2fc69398e958f2893f953d030448650a000000004847304402200dd5c481da9011a6b3e8f7c226893c95391ba9050605cc54e13c5d33eaf5cf3602207803308d4375d7515e18f1b8e096cbfed6c06fa798b9f8bd4ee8734c038a6b2001ffffffffad030661ff730cd18ef2e9502738fabf2490f3710dfb5a78625e0e60061fd11c020000008a473044022071cba1a9e2439079c9016ec25f23e36b6eb30aa93be5fe78acb5a690f65dc91202201a949b12149a815ab5dc08d31f54738dd3a6a8e294026827ba687b6d557a929d0141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff038014f840000000001976a91400b549030f16ef029d29bf93df47f09a2cdd381688ac0000000000000000166a14dc24e2f1b749151460c377e91e4c1f08b25e98870049d971020000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000200000057eb9960b49570f8940d27c01a27ca81147e365f103a999d9e1aa21969a0bf8f";

    std::string strD15 = "00dc24e2f1b749151460c377e91e4c1f08b25e98870200000002a5298ec44170a3557e83bebd1a2992c86b216150189b2061cf2763b3b67c78570000000048473044022033de2a6cd50f222d816177cb01c4da9dada5a8e279676bb57b5705868c59514a02205456ec226bf19c9f29666f11d474fc8815e36fc9b77531ff5cc748a27eae1a9301ffffffff5e8809bbd98ee24b6ce4dcadfeee7883a7bb7dcc01243180938c652c3f580482020000008b483045022100fe87e1a26fb4ab96d95f89867ee10a4a2c2686a47a6859bcbe588da72e76c31d02204c1d06303bb01ec45f5363acb29a0e288ea506c91b1694792c7a54e6cf83e6400141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff038033023b000000001976a914b71343a02996fdce2486531f388fb3dc18403ca588ac0000000000000000166a14dc24e2f1b749151460c377e91e4c1f08b25e9887007841cb020000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000200000057eb9960b49570f8940d27c01a27ca81147e365f103a999d9e1aa21969a0bf8f";

    std::string strD16 = "00dc24e2f1b749151460c377e91e4c1f08b25e988702000000028eee629991eef6c7a47b84eecff07d6c3c67ad4b5f2cbb5f51882bc62d5546b70000000049483045022100ca6e0d7be46bd17c23023ad03e059e755afc71df9bdcafdb8d1fa7c4fc5b9ab402201cc3158c5b23ac0c4fa0365998458779b0698ec62672a23d8b8abb8e443cb42601ffffffff5cf065b38e05cbd6f9606389181049b76593034b71d53bec148a0a3509df3f2c020000008b483045022100d51376bb647d2ca049f23e1779ef58f7a2893e320f55b383072a77824638e3da0220228ddec4e4a0a7877ff6ebea75dca7ed36e715b7241db5f2acd83d2ba5e6afcf0141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff0380520c35000000001976a914279af35ab197ff834b3afd664c320a0baec6869588ac0000000000000000166a14dc24e2f1b749151460c377e91e4c1f08b25e988700889f2a030000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000200000057eb9960b49570f8940d27c01a27ca81147e365f103a999d9e1aa21969a0bf8f";

    std::string strD17 = "00dc24e2f1b749151460c377e91e4c1f08b25e988702000000028665c4140be909bbc1b51d2229f05b7e256650d13d52d65988ec42e20b30274800000000494830450221008721d451726882e40ba756f9fd3bec35fffd3fcff8409b2cc116645dda65bf3802203d1b6aab587271063f7acebce203c8a6c14944088ce9d390b36723da6361b23701ffffffff6cbe67f54383e19c7c5e26e5cbeb5a95e8ae2bd0b6fcbe3c33a99c5a4e71a06e020000008b483045022100c78f19a8138a84dee65b50c2e52c8fe4b8fb825d76b53c870d6e892c6069877002203b43e0134e703db61ed4a3bc851567f8288cccd3ee13ac45c05b6e845fb731ed0141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff038071162f000000001976a91401cdb8923fcfb26f4874b6023e67e08bb757d11688ac0000000000000000166a14dc24e2f1b749151460c377e91e4c1f08b25e98870079f38f030000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000200000057eb9960b49570f8940d27c01a27ca81147e365f103a999d9e1aa21969a0bf8f";

    std::string strD18 = "00dc24e2f1b749151460c377e91e4c1f08b25e988702000000029603ee7d0f4f9351feab37211edcb64d6650220b7e30141715d6f27df60c152e00000000484730440220068701dec87a1c3e573da453950c7071b1513d4ed530a71da121419724c1d762022018960e72527c6f4f3cecdfb06b8fbefafca4fe61ae5ca99ec99fbedfa05b4e4901ffffffffff925ead9a8b585e909f8c6042c1d4e1ffb41c0c1b89ccb51b92bf6c9243b8ca020000008b483045022100c7f5c7e3a54addf53dc3646d41e9aa679c2b7d580bab0710e7d887b469f4ed820220744a3bcba2765b21025aa4438b0204d108633dc5d1d804c67abfde2ff01795bc0141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff0380902029000000001976a914b5495d9221c1bd75ac826cf145fe25765f32b3ae88ac0000000000000000166a14dc24e2f1b749151460c377e91e4c1f08b25e9887004b3dfb030000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000200000057eb9960b49570f8940d27c01a27ca81147e365f103a999d9e1aa21969a0bf8f";

    std::string strD19 = "00dc24e2f1b749151460c377e91e4c1f08b25e98870200000002ce5a0c4a0ede2bcceefddedc91032857481002e4bbd86b03d2178997878a03770000000049483045022100dcd84fb8f050e1a695b2b48a03634d8b5e9ec20a5e1229e54c362532abdc54970220235165bfa98b164ef353cb7dad97d414f43d671583108126541214c2b46279df01ffffffff5390f839fc42c92a1320ef0c08bf27482063f42770d2f8b12a3cc4704fd2ccdb020000008b483045022100f6522796d7193377fdd0616f7b4f43894860b3fdc09ff7734d765e334844368802206c134c29dcfb24fb165d4a5cedd7a46eed188d5ac1de1467488e02662431e9fc0141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff0380af2a23000000001976a914ca814e11ed342b2a18209e53c9ee4ca80c95f99288ac0000000000000000166a14dc24e2f1b749151460c377e91e4c1f08b25e988700fe7c6c040000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000200000057eb9960b49570f8940d27c01a27ca81147e365f103a999d9e1aa21969a0bf8f";

    std::string strD20 = "00dc24e2f1b749151460c377e91e4c1f08b25e988702000000029a55ca1e4df45b3bc949833fe638481613604f8d6037a844be9faf12763407f00000000049483045022100aa288e36db38a0945d272747b5530679af0b8f8fe20aefbb7d2b83d95b3cb08f02203c7f98a690c689ecf18e8804b490b2943dcb0f319ab5a1053fa58b6d9291455e01fffffffff6bc36b7892e3b37d3cb7bf17b198a6ba9401bb1cf594d817db8d0ac904154eb020000008a47304402201e5c3c7ba507ffe55f8cebd5be2b9fedceead3a33d4f7a3edada34f2d8ecf6c70220649599467ff913147c5883c9cd1d8084ebb0db61ac99cfbd702e9635af514cd30141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff0380ce341d000000001976a914639e215d5f6c78f9710936f3b3416bf6f040011d88ac0000000000000000166a14dc24e2f1b749151460c377e91e4c1f08b25e98870092b2e3040000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000200000057eb9960b49570f8940d27c01a27ca81147e365f103a999d9e1aa21969a0bf8f";

    std::string strD21 = "00dc24e2f1b749151460c377e91e4c1f08b25e988702000000021a2512059af7921302dac95d9dbcf46da08db1ef1aa25fd252005e91ee98d0250000000048473044022055d5e86d3132db64591d1658fa45e812bab42bb686498bb4544aec9df7e7282b02201e51afe69e4e8775564b57d696fda41793e7b8f1d9ed644ea7228dce62a7f7c401ffffffffaa336fd7cef6b8af45e14534e2c7398af9159b5aee34c5cecf75db176cce9e4d020000008b483045022100ed9f412e5e24ac4e88f52007ac9cd1a864bcbd6b11d087cbbfad459de4953e1a02205646039835593b60ba94201dc5ee0dac936b4f15cdc7f56735f339aced1d043c0141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff0380ed3e17000000001976a9148cbfc18351390c42157e9e283d91c4b0fb7b815688ac0000000000000000166a14dc24e2f1b749151460c377e91e4c1f08b25e98870007de60050000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000200000057eb9960b49570f8940d27c01a27ca81147e365f103a999d9e1aa21969a0bf8f";

    std::string strD22 = "00dc24e2f1b749151460c377e91e4c1f08b25e988702000000023ab4544cbd2b1b27f458f8da0d5903fe2c6ea3c8ed530583e2ed4f6c87730d720000000049483045022100d0aea0c62b81f540574afd6139f54b5b6568ba185f077ef1bb6222e1e4fca43b022075b0b6abdb4b2070fb8195c98e50dc04bd8fd0fbb8d51b5371fba3a0d337027c01ffffffffaa6de5318e5100748680a75a833acb9900487432e18e4dff7ec616f16ba491e9020000008b483045022100859955ca98e9d43745daea4355ec167a5b4d2061c11c9f218bc1ff016f5827a402202ceb8ccd1725ae65bbca143330fd20fa498237294228b48c0a077c96949736850141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff03800c4911000000001976a9149a480efd9a961b9876f10fcf563386c9b42e3bf588ac0000000000000000166a14dc24e2f1b749151460c377e91e4c1f08b25e9887005dffe3050000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000200000057eb9960b49570f8940d27c01a27ca81147e365f103a999d9e1aa21969a0bf8f";

    std::string strD23 = "00dc24e2f1b749151460c377e91e4c1f08b25e988702000000028b071889c6a686cf1965467fd10305b7d9c115e3c0f628caefe24e946c99f99c0000000049483045022100e4b3d1c7bafb35791d2ec060a6ef953359ed4211dd2b23b126d0f442d598142302200b484e7eaefb354ded4132979f873d652297454dd8f4022bd6e578eead7cd60501ffffffff70b8e9d17a50371ff75254b6e2a7b91a23434e4bbdf4c5f04a6846390ef9cefe020000008b483045022100bcc4f36ed967f3ef9c4d4fa959f98ded87f53e29573f54db7bc49d233f30e4b8022050cfc3565e354dc564cf0f906e30e9dc7147b7ac2711a31ff0e9e769f6a0e6580141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff03802b530b000000001976a91493eb548991b325cd6486c75e850b033adafc8ad488ac0000000000000000166a14dc24e2f1b749151460c377e91e4c1f08b25e98870094166d060000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000200000057eb9960b49570f8940d27c01a27ca81147e365f103a999d9e1aa21969a0bf8f";

    std::string strD24 = "00dc24e2f1b749151460c377e91e4c1f08b25e98870200000002b0d8aec61fd1865e90768e7c037a910478b788b613a07dbca5d60b72f5b7d9da0000000048473044022020c1dc51849cce3578c3390d61d94f9866039e49cf7287cc241ccb8f1d8bd5e30220308675b988988b264f201f0917a0717a9ee22e9dafbf8185d380a5f9b5cb6b6701ffffffff0d6e66df74bd7e145d9022dc293512dd42bb7c8000372bd34b0dd7cecbf0ddbf020000008a473044022015ea381d076e0822ba33ce37b0dd7980d33f40462adc9becbb6511dc5c7a6ebb022030805e1343a5db6818e139d4faf691407afefbc8897082497e1276b6967b551e0141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff03804a5d05000000001976a914b6fdc6b682c264f0d150604e57043fd082e74be988ac0000000000000000166a14dc24e2f1b749151460c377e91e4c1f08b25e988700ac23fc060000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000200000057eb9960b49570f8940d27c01a27ca81147e365f103a999d9e1aa21969a0bf8f";

    std::string strD25 = "00dc24e2f1b749151460c377e91e4c1f08b25e98870200000002ca721a41598d6c54bbcfc0c47828ee781fd5b2fd780542247ba2fc7ff65589300000000049483045022100c9914bf1337e42a1d1d5852e5731fff623adb2b9884f1a551837fd89554ab09602205424460e08696a2f818a164d76371644d0ea3ad580d9b9d9237e5fef4334712c01ffffffff3294b2fbd7b7aca5a4c0f762aad819aa56596010dfde952a0cbc0e12341a030e020000008b483045022100cdb4d89f93ac3232243b4af2c5ffaba5438143b0e2bf700c518329ed4e1b1cdf022069850b96cb6a43b7b10e2c7625f84d66f969db67159fb5640de7918cd609c3a60141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff0380626a94000000001976a914207a13b135c5cb2c6745be2ce57ed86c6feb742b88ac0000000000000000166a14dc24e2f1b749151460c377e91e4c1f08b25e988700a52691070000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000200000057eb9960b49570f8940d27c01a27ca81147e365f103a999d9e1aa21969a0bf8f";

    CDataStream ss1(ParseHex(strD1), SER_DISK, CLIENT_VERSION);
    CDataStream ss2(ParseHex(strD2), SER_DISK, CLIENT_VERSION);
    CDataStream ss3(ParseHex(strD3), SER_DISK, CLIENT_VERSION);
    CDataStream ss4(ParseHex(strD4), SER_DISK, CLIENT_VERSION);
    CDataStream ss5(ParseHex(strD5), SER_DISK, CLIENT_VERSION);
    CDataStream ss6(ParseHex(strD6), SER_DISK, CLIENT_VERSION);
    CDataStream ss7(ParseHex(strD7), SER_DISK, CLIENT_VERSION);
    CDataStream ss8(ParseHex(strD8), SER_DISK, CLIENT_VERSION);
    CDataStream ss9(ParseHex(strD9), SER_DISK, CLIENT_VERSION);
    CDataStream ss10(ParseHex(strD10), SER_DISK, CLIENT_VERSION);
    CDataStream ss11(ParseHex(strD11), SER_DISK, CLIENT_VERSION);
    CDataStream ss12(ParseHex(strD12), SER_DISK, CLIENT_VERSION);
    CDataStream ss13(ParseHex(strD13), SER_DISK, CLIENT_VERSION);
    CDataStream ss14(ParseHex(strD14), SER_DISK, CLIENT_VERSION);
    CDataStream ss15(ParseHex(strD15), SER_DISK, CLIENT_VERSION);
    CDataStream ss16(ParseHex(strD16), SER_DISK, CLIENT_VERSION);
    CDataStream ss17(ParseHex(strD17), SER_DISK, CLIENT_VERSION);
    CDataStream ss18(ParseHex(strD18), SER_DISK, CLIENT_VERSION);
    CDataStream ss19(ParseHex(strD19), SER_DISK, CLIENT_VERSION);
    CDataStream ss20(ParseHex(strD20), SER_DISK, CLIENT_VERSION);
    CDataStream ss21(ParseHex(strD21), SER_DISK, CLIENT_VERSION);
    CDataStream ss22(ParseHex(strD22), SER_DISK, CLIENT_VERSION);
    CDataStream ss23(ParseHex(strD23), SER_DISK, CLIENT_VERSION);
    CDataStream ss24(ParseHex(strD24), SER_DISK, CLIENT_VERSION);
    CDataStream ss25(ParseHex(strD25), SER_DISK, CLIENT_VERSION);

    // Unserialize the testing deposits

    SidechainDeposit d1;
    ss1 >> d1;
    SidechainDeposit d2;
    ss2 >> d2;
    SidechainDeposit d3;
    ss3 >> d3;
    SidechainDeposit d4;
    ss4 >> d4;
    SidechainDeposit d5;
    ss5 >> d5;
    SidechainDeposit d6;
    ss6 >> d6;
    SidechainDeposit d7;
    ss7 >> d7;
    SidechainDeposit d8;
    ss8 >> d8;
    SidechainDeposit d9;
    ss9 >> d9;
    SidechainDeposit d10;
    ss10 >> d10;
    SidechainDeposit d11;
    ss11 >> d11;
    SidechainDeposit d12;
    ss12 >> d12;
    SidechainDeposit d13;
    ss13 >> d13;
    SidechainDeposit d14;
    ss14 >> d14;
    SidechainDeposit d15;
    ss15 >> d15;
    SidechainDeposit d16;
    ss16 >> d16;
    SidechainDeposit d17;
    ss17 >> d17;
    SidechainDeposit d18;
    ss18 >> d18;
    SidechainDeposit d19;
    ss19 >> d19;
    SidechainDeposit d20;
    ss20 >> d20;
    SidechainDeposit d21;
    ss21 >> d21;
    SidechainDeposit d22;
    ss22 >> d22;
    SidechainDeposit d23;
    ss23 >> d23;
    SidechainDeposit d24;
    ss24 >> d24;
    SidechainDeposit d25;
    ss25 >> d25;

    std::vector<SidechainDeposit> vDeposit { d1, d2, d3, d4, d5, d6, d7, d8,
        d9, d10, d11, d12, d13, d14, d15, d16, d17, d18, d19, d20, d21, d22,
        d23, d24, d25 };

    // Enable this for debugging
    //int i = 0;
    //for (const SidechainDeposit& d : vDeposit) {
    //    std::cout << "Deposit " << i << ":\n";
    //    std::cout << d.ToString() << std::endl;
    //    i++;
    //}

    return vDeposit;
}

BOOST_AUTO_TEST_CASE(sidechain_sort_10_deposits)
{
    // This test is testing 10 deposits which all spend different transactions

    // Get 10 deposits in valid CTIP spend order
    std::vector<SidechainDeposit> vD = Get10TestDeposits();

    // Test sorting the deposits when they are already in valid order
    std::vector<SidechainDeposit> vDepositSorted;
    BOOST_CHECK(SortDeposits(vD, vDepositSorted));
    BOOST_CHECK(vD == vDepositSorted);

    vDepositSorted.clear();

    // Test sorting from reverse order
    std::vector<SidechainDeposit> vReverse = vD;
    std::reverse(vReverse.begin(), vReverse.end());
    BOOST_CHECK(SortDeposits(vReverse, vDepositSorted));
    BOOST_CHECK(vD == vDepositSorted);

    vDepositSorted.clear();

    // Test sorting a random order
    std::vector<SidechainDeposit> vRandom {vD[1], vD[0], vD[3], vD[2], vD[4],
        vD[5], vD[7], vD[6], vD[9], vD[8]};

    BOOST_CHECK(vRandom != vD);
    BOOST_CHECK(SortDeposits(vRandom, vDepositSorted));
    BOOST_CHECK(vDepositSorted == vD);
}

BOOST_AUTO_TEST_CASE(sidechain_sort_25_deposits_1)
{
    // This test is testing 25 deposits some of which spend different outputs
    // of the same transaction

    // Get 25 deposits in valid CTIP spend order
    std::vector<SidechainDeposit> vD = Get25TestDeposits();

    // Test sorting the deposits when they are already in valid order
    std::vector<SidechainDeposit> vDepositSorted;
    BOOST_CHECK(SortDeposits(vD, vDepositSorted));
    BOOST_CHECK(vD == vDepositSorted);

    vDepositSorted.clear();

    // Test sorting from reverse order
    std::vector<SidechainDeposit> vReverse = vD;
    std::reverse(vReverse.begin(), vReverse.end());
    BOOST_CHECK(SortDeposits(vReverse, vDepositSorted));
    BOOST_CHECK(vD == vDepositSorted);

    vDepositSorted.clear();

    // Test sorting random order
    std::vector<SidechainDeposit> vRandom {vD[1], vD[0], vD[21], vD[16], vD[4],
        vD[24], vD[15], vD[7], vD[9], vD[8], vD[13], vD[11], vD[12], vD[10],
        vD[14], vD[6], vD[3], vD[17], vD[20], vD[19], vD[18], vD[2],
        vD[22], vD[23], vD[5]};

    BOOST_CHECK(vRandom != vD);
    BOOST_CHECK(SortDeposits(vRandom, vDepositSorted));
    BOOST_CHECK(vDepositSorted == vD);
}

BOOST_AUTO_TEST_CASE(sidechain_sort_25_deposits_2)
{
    // Another test sorting 25 deposits

    // Get 25 deposits in valid CTIP spend order
    std::vector<SidechainDeposit> vD = Get25TestDeposits();

    // Test sorting the deposits when they are already in valid order
    std::vector<SidechainDeposit> vDepositSorted;
    BOOST_CHECK(SortDeposits(vD, vDepositSorted));
    BOOST_CHECK(vD == vDepositSorted);

    vDepositSorted.clear();

    // Test sorting from reverse order
    std::vector<SidechainDeposit> vReverse = vD;
    std::reverse(vReverse.begin(), vReverse.end());
    BOOST_CHECK(SortDeposits(vReverse, vDepositSorted));
    BOOST_CHECK(vD == vDepositSorted);

    vDepositSorted.clear();

    // Test sorting random order
    std::vector<SidechainDeposit> vRandom {vD[24], vD[0], vD[21], vD[11], vD[4],
        vD[1], vD[15], vD[12], vD[9], vD[8], vD[13], vD[2], vD[7], vD[10],
        vD[14], vD[6], vD[19], vD[23], vD[20], vD[3], vD[18], vD[16],
        vD[22], vD[17], vD[5]};

    BOOST_CHECK(vRandom != vD);
    BOOST_CHECK(SortDeposits(vRandom, vDepositSorted));
    BOOST_CHECK(vDepositSorted == vD);
}

BOOST_AUTO_TEST_CASE(sidechain_sort_25_deposits_invalid)
{
    // Check that sorting fails when invalid (duplicate and missing)
    // deposits try to be sorted

    // Get 25 deposits in valid CTIP spend order
    std::vector<SidechainDeposit> vD = Get25TestDeposits();

    // Test sorting the deposits when they are already in valid order
    std::vector<SidechainDeposit> vDepositSorted;
    BOOST_CHECK(SortDeposits(vD, vDepositSorted));
    BOOST_CHECK(vD == vDepositSorted);

    vDepositSorted.clear();

    // Test sorting from reverse order
    std::vector<SidechainDeposit> vReverse = vD;
    std::reverse(vReverse.begin(), vReverse.end());
    BOOST_CHECK(SortDeposits(vReverse, vDepositSorted));
    BOOST_CHECK(vD == vDepositSorted);

    vDepositSorted.clear();

    // Test failure when there are duplicate deposits
    std::vector<SidechainDeposit> vDuplicate {vD[0], vD[0], vD[2], vD[3], vD[4],
        vD[5], vD[6], vD[7], vD[8], vD[9], vD[10], vD[11], vD[11], vD[11],
        vD[14], vD[15], vD[16], vD[17], vD[18], vD[19], vD[20], vD[21],
        vD[22], vD[22], vD[22]};

    BOOST_CHECK(!SortDeposits(vDuplicate, vDepositSorted));
    BOOST_CHECK(vDepositSorted != vD);

    vDepositSorted.clear();

    // Test failure when there are missing deposits
    std::vector<SidechainDeposit> vMissing {vD[0], vD[1], /* vD[2], */ vD[3],
        vD[4], vD[5], vD[6], vD[7], vD[8], vD[9], vD[10], vD[11], vD[12],
        vD[13], vD[14], vD[15], vD[16], vD[17], vD[18], vD[19], vD[20], vD[21],
        vD[22], vD[23] /* vD[24] */ };

    BOOST_CHECK(!SortDeposits(vMissing, vDepositSorted));
    BOOST_CHECK(vDepositSorted != vD);
}

BOOST_AUTO_TEST_SUITE_END()
